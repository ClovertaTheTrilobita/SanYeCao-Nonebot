# SanYeCao-Nonebot

## ğŸ“šä»‹ç»

<p align="center">ğŸŒŸä¸‰å¶è‰bot 2.0ğŸŒŸ<br>
ğŸš€ä½¿ç”¨Nonebot2+å®˜æ–¹APIæ­å»ºçš„QQç¾¤èŠæœºå™¨äººğŸš€<br><br>
<img alt="Static Badge" src="https://img.shields.io/badge/Python-3.11%2F3.12-blue">
<img alt="Static Badge" src="https://img.shields.io/badge/Nonebot-2.0-green">
<img src="https://img.shields.io/github/last-commit/ClovertaTheTrilobita/SanYeCao-Nonebot" alt="last-commit" />
<img alt="Static Badge" src="https://img.shields.io/badge/QQ%E7%BE%A4-710101225-orange"><br><br>
</p>


## ğŸ”–äº®ç‚¹

- åŸºäº[Nonebot2](https://nonebot.dev/)ï¼Œä½¿ç”¨[QQå®˜æ–¹API](https://bot.q.qq.com/wiki/)ï¼Œæ›´ç¨³å®šã€é«˜æ•ˆâœ¨
- å¤šç§ä¸ªæ€§åŒ–ç”¨æ³•ï¼Œå¦‚å¤©æ°”ã€æ¯æ—¥è¿åŠ¿(~~æœºå™¨äººæ—¶å°šå•å“~~)ã€ç‚¹æ­Œã€ç¼–è¾‘ä¸ªäººå¾…åŠç­‰ï¼Œåç»­åŠŸèƒ½å¼€å‘ä¸­ğŸ”§
- ä½¿ç”¨è½»é‡åŒ–æ•°æ®åº“sqliteç®¡ç†æ•°æ®ï¼Œå®ç°ä¸ºæ¯ä½ç”¨æˆ·å•ç‹¬å­˜å–æ•°æ®ğŸ”
- æ¥å…¥ç¬¬ä¸‰æ–¹å¤§è¯­è¨€æ¨¡å‹ï¼Œå®ç°AIäº¤äº’ğŸ’¡

<br>

###### æˆ‘æ˜¯èœæ¯”ğŸ³ï¸ğŸ³ï¸ï¼Œçº¯æ–°æ‰‹å†™çš„python é—®é¢˜è‚¯å®šå¤š ï¼Œè‹¥æœ‰å…´è¶£å¯ä»¥å¸®å¿™ä¸€èµ·å®Œå–„åŠŸèƒ½ <br>
###### QQäº¤æµç¾¤ï¼š[710101225](https://qm.qq.com/q/AQyepzKUJq) 

<br>

- â†‘slyæ˜¯ä»£ç é¢†åŸŸå¤§ç¥ï¼Œ ğŸ‘ˆ ClovertaTheTrilobita å†™çš„

## ğŸŒˆç›®å‰åŠŸèƒ½:

- [x] å¾…åŠ
- [x] å¤©æ°” 
- [x] ä»Šæ—¥è¿åŠ¿
- [x] ä»Šæ—¥å¡”ç½—
- [x] ç‚¹æ­Œï¼ˆç½‘æ˜“äº‘ éœ€æ‰«ç ç™»å½• åœ¨ src\music ç›®å½•ä¸‹ï¼‰
- [x] å›¾ï¼ˆè¿”å›å›¾åº“ä¸­çš„å›¾ç‰‡ï¼‰
- [x] æ‘¸æ‘¸å¤´
- [x] æ¥å…¥è¯­è¨€æ¨¡å‹
- [x] æœç´¢Bç«™è§†é¢‘
- [ ] ä»Šæ—¥è€å©†
- [x] ç¾¤è€å©†
- [x] é²è¿…è¯´
- [x] å–œæŠ¥ã€æ‚²æŠ¥
- [x] æŸ¥è¯¢cfæ¯”èµ›
- [x] æ—¥æŠ¥
- [x] æŸ¥è¯¢çƒ­é—¨è½»å°è¯´
- [x] è·å–æ–°ç•ªä¿¡æ¯
- [x] ç»å¯¹è‰²æ„Ÿ

#### æ›´å¤šè¯¦ç»†åŠŸèƒ½è¯·æŸ¥çœ‹<b>[features.md](docs/features.md)</b>.


## ğŸ› ï¸ å®‰è£…

- å…³äºNonebotå®Œæ•´éƒ¨ç½²ä½¿ç”¨æ–¹æ³•ï¼Œè¯·æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://nonebot.dev/)

<br>


### âš™ï¸ä¸€ã€ç¯å¢ƒé…ç½®

**æˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ**ï¼Œè‹¥æ‚¨ä½¿ç”¨Anacondaå‘è¡Œç‰ˆï¼Œè¯·åœ¨ç»ˆç«¯è¾“å…¥

```powershell
conda create --name chatbot python=3.11
```

åˆ›å»ºcondaç¯å¢ƒã€‚

ä¹‹å

```powershell
conda activate chatbot
```

ä»¥å¯ç”¨æ‚¨åˆšåˆšåˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒã€‚

ä½ ä¹Ÿå¯ä»¥å°†ä¸Šè¿° *chatbot* æ›´æ¢ä¸ºä½ å–œæ¬¢çš„åå­—ã€‚

<b>ğŸš«æ³¨æ„ï¼š</b>æœºå™¨äºº<b>ä¸</b>æ”¯æŒ<img alt="Static Badge" src="https://img.shields.io/badge/Python-3.13/+-blue">çš„å‘è¡Œç‰ˆï¼Œæ¨èä½¿ç”¨<img alt="Static Badge" src="https://img.shields.io/badge/Python-3.11%2F3.12-blue">

<br>

### ğŸ§ª å®‰è£…æ‰€éœ€ä¾èµ–

<br>

æ­¤æœºå™¨äººè¿è¡Œæ‰€éœ€ä¾èµ–å·²å…¨éƒ¨æ‰“åŒ…è‡³***requirements.txt***ï¼Œæ‚¨åªéœ€å›åˆ°é¡¹ç›®æ ¹ç›®å½•

åœ¨ç»ˆç«¯è¾“å…¥ï¼š

```powershell
pip install -r requirements.txt
```
<br>

### ğŸµ ç½‘æ˜“äº‘ç‚¹æ­Œä¾èµ–å®‰è£…

#### 1. å®‰è£… Node.js ç¯å¢ƒ
- **å®˜ç½‘ä¸‹è½½**ï¼šè®¿é—® [Node.js å®˜ç½‘](https://nodejs.org/) ä¸‹è½½ LTS ç‰ˆæœ¬ï¼ˆæ¨è v18.x+ï¼‰
- **å®‰è£…æ³¨æ„**ï¼š
  - å‹¾é€‰ `Add to PATH` é€‰é¡¹ï¼ˆè‡ªåŠ¨é…ç½®ç¯å¢ƒå˜é‡ï¼‰
  - å®Œæˆå®‰è£…åé‡å¯ç»ˆç«¯ä½¿é…ç½®ç”Ÿæ•ˆ
  éªŒè¯ Node.js ç‰ˆæœ¬
- **å¯¹äºDebian/Ubuntu**
- ä½ å¯ä»¥ç›´æ¥ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…
  ```shell
  sudo apt install nodejs npm
  ```
#### 2. éªŒè¯å®‰è£…ç»“æœ
```powershell
npm -v
```
#### 3. å®‰è£… crypto-js åº“
åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š
```powershell
npm install crypto-js
```
<br>

### âœ’ï¸äºŒã€é…ç½®æ‰€éœ€æ–‡ä»¶

åœ¨ä¸€åˆ‡å¼€å§‹å‰ï¼Œä½ éœ€è¦å°†é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„[<b>example.env.prod</b>](example.env.prod)æ–‡ä»¶æ›´åä¸º<b><i>.env.prod</i></b>ï¼Œè¿™æ˜¯æœºå™¨äººçš„è´¦å·é…ç½®æ–‡ä»¶ã€‚

æˆ‘åŠ äº†ç¥å¿…å°ä»£ç ï¼Œå¦‚æœä½ æ²¡é…ç½®è¿™ä¸¤ä¸ªé…ç½®æ–‡ä»¶æ˜¯å¯åŠ¨ä¸èµ·æ¥çš„ï¼Œå› ä¸ºæœ‰<span style="color:gray">~~æµ·é‡~~</span>ä¸ªä¾‹æ˜¾ç¤ºï¼Œå¾ˆå¤šäººä¸çœ‹READMEå°±æƒ³å½“ç„¶åœ°å¯åŠ¨botï¼Œå¹¶åœ¨ç¾¤é‡Œé—®ä¸ºä»€ä¹ˆä¼šæœ‰æŠ¥é”™ï¼ˆ

```
DRIVER=~fastapi+~httpx+~websockets

QQ_IS_SANDBOX=false

QQ_BOTS="
[
  {
    "id": "xxx",
    "token": "xxx",
    "secret": "xxx",
    "intent": {
      "c2c_group_at_messages": true
    },
    "use_websocket": true
  }
]
"
```
åˆ†åˆ«åœ¨idã€tokenã€secretå¤„å¡«å†™ä½ çš„æœºå™¨äººIDï¼Œæœºå™¨äººTokenå’ŒApple Secretï¼Œéœ€ä»[QQå¼€æ”¾å¹³å°](https://q.qq.com/)è·å–ã€‚

<br>

#### ğŸ“„ éœ€è¦ä¿®æ”¹çš„é…ç½®æ–‡ä»¶

é¦–å…ˆæ‰¾åˆ° [**example.config.yaml**](example.config.yaml) ï¼Œå°†å…¶é‡å‘½åä¸º<b>config.yaml</b>

å¹¶æ ¹æ®éœ€è¦æ›¿æ¢ä»¥ä¸‹é…ç½®é¡¹ï¼š

```yaml
#######################################
# å¦‚æœæ‚¨å·²ç»é…ç½®å¥½äº†ï¼Œè¯·å°†æ­¤å­—æ®µæ”¹ä¸º â€˜Falseâ€™#
#######################################
default: "True" # é…ç½®å®Œæˆåï¼Œè¯·å°†è¿™ä¸ªå­—æ®µæ”¹ä¸º False

bot:
  app_id: ""
  bot_account: ""

############################
#     ä¸‰å¶è‰é‚®ç®±å‘ä¿¡è®¾ç½®      #
############################
mail:
  google:
    enabled: 'False'
    smtp_server: 'smtp.gmail.com'
    email: 'xxxxxx@gmail.com'
    password: '1234567891234567' # 16 ä½åº”ç”¨ç 

  qq:
    enabled: 'True'
    smtp_server: 'smtp.qq.com'
    email: 'xxxxxxxx@qq.com'
    password: '1234567891234567' # qqé‚®ç®±åº”ç”¨ç 

  server: # è‡ªå»ºæœåŠ¡å™¨
    enabled: 'False'
    smtp_server: 'mail.example.com' # è‡ªå»ºé‚®å±€åŸŸå
    email: 'user_name@example.com'
    password: '123456'
    port: '587'

############################
#       ä¸‰å¶è‰å›¾åºŠè®¾ç½®       #
############################
image_hosting:
  smms: # sm.mså›¾åºŠ
    enabled: 'False'
    token: '<KEY>'
    smms_image_upload_history: "https://sm.ms/api/v2/upload_history"

  superbed: # èšåˆå›¾åºŠ
    enabled: 'False'
    token: '<KEY>'
    superbed_image_list: "https://api.superbed.cn/timeline"

  random_pic: "https://image.anosu.top/pixiv/json"

  animetrace:
    url: "https://api.animetrace.com/v1/search"

############################
#        ä¸‰å¶è‰AIè®¾ç½®        #
############################
ai:
  admin:
    password: '123456'

  api:
    v3:
      enabled: "False"
      url: "https://api.vveai.com/v1/chat/completions"
      key: '<KEY>'

    deepseek:
      enabled: "False"
      url: "https://api.deepseek.com"
      key: '<KEY>'

    silicon_flow:
      enabled: "True"
      url: "https://api.siliconflow.cn/v1/chat/completions"
      model: "Pro/deepseek-ai/DeepSeek-V3"
      key: '<KEY>'

############################
#       å…¶ä»–æ—¶å°šå°åŠŸèƒ½       #
############################

wenku8:
  # é€šè¿‡wenku8.comè·å–æœ€æ–°è½»å°è¯´å’¨è¯¢
  # æ­¤åŠŸèƒ½éœ€è¦å¯ç”¨ä»£ç†
  enabled: 'False'
  user_name: '<user_name>'
  password: '<passwd>'

proxy:
  # ç›®å‰ä»£ç ä¸­ä»…æ”¯æŒå¤šç±³HTTPä»£ç†
  enabled: 'False'
  key: '<KEY>'

qr:
  # äºŒç»´ç ç”Ÿæˆapi
  url: "https://api.qrserver.com/v1/create-qr-code/"
  size: "200x200"

codeforces:
  # æŸ¥è¯¢codeforcesæ¯”èµ›åˆ—è¡¨
  key: "<KEY>"
  secret: "<KEY>"
```

<b>ğŸš«æ³¨æ„ï¼š</b> å°†ä½ çš„ `app_id` å’Œ `smms_token` æ›¿æ¢ä¸ºå®é™…å€¼ï¼ˆå¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚é€‰å¡«ï¼‰

<br>

### ğŸ“ä¸‰ã€å¯åŠ¨æœºå™¨äºº

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œæ‰¾åˆ° *bot.py* ï¼Œåœ¨ç»ˆç«¯è¾“å…¥

```powershell
python bot.py
```

<br>

<br>

### ğŸ¨ åŠŸèƒ½è¡¥å……è¯´æ˜


#### ğŸµ ä½¿ç”¨ç½‘æ˜“äº‘APIå®ç°ç‚¹æ­Œ

è‹¥æ‚¨æ˜¯åˆæ¬¡ä½¿ç”¨ç‚¹æ­ŒåŠŸèƒ½ï¼Œåœ¨ç¾¤èŠä¸­ @ æœºå™¨äººåï¼Œæœºå™¨äººä¼šæç¤ºï¼š

```
ç™»å½•å¤±æ•ˆï¼Œè¯·è”ç³»ç®¡ç†å‘˜è¿›è¡Œç™»å½•
```


æ­¤æ—¶ä¼šåœ¨ [**src/music**](src/clover_music) ç›®å½•ä¸‹ç”Ÿæˆä¸€å¼  **qrcode.png**ï¼Œæ‚¨éœ€è¦ä½¿ç”¨æ‰‹æœºç«¯ç½‘æ˜“äº‘éŸ³ä¹æ‰«ç è¯¥äºŒç»´ç ï¼Œç™»å½•æ‚¨çš„ç½‘æ˜“äº‘è´¦å·ã€‚

<b>æ³¨æ„ï¼š</b> æˆ‘ä»¬ä½¿ç”¨ cookie å­˜å‚¨ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼Œæ‰€ä»¥ä¼šå­˜åœ¨ç™»å½•è¿‡æœŸçš„æƒ…å†µã€‚è‹¥ cookie è¿‡æœŸï¼Œæœºå™¨äººä¼šæç¤ºï¼š

```
æ­Œæ›²éŸ³é¢‘è·å–å¤±è´¥ï¼šç™»å½•ä¿¡æ¯å¤±æ•ˆã€‚
```


æ­¤æ—¶éœ€è¦å¹¶é‡æ–°æ‰«ç ç™»å½•ã€‚

<br>

#### âœ‹ ç®¡ç†å‘˜èº«ä»½è®¤è¯

##### ä»‹ç»

æœºå™¨äººç®¡ç†å‘˜å¯ä»¥æ§åˆ¶æ˜¯å¦ä½¿ç”¨ç¬¬ä¸‰æ–¹å¤§è¯­è¨€æ¨¡å‹è¿›è¡Œäº¤äº’ã€‚åç»­å…¶å®ƒåŠŸèƒ½æ›´æ–°ä¸­ã€‚

##### ä½¿ç”¨

###### 1. æ³¨å†Œä¸ºç®¡ç†å‘˜ <a id="admin_control"></a>

åœ¨ [**config.yaml**](config.yaml) å†…ï¼Œæ‰¾åˆ°ï¼š

```python
ai:
  admin:
    password: '123456'
```


å¯ä»¥æ›´æ”¹ä¸ºè‡ªå·±çš„å¯†ç ã€‚

è®¾ç½®å¥½å¯†ç åï¼Œåœ¨ QQ ä¸­ at ä½ çš„æœºå™¨äººï¼Œæ ¼å¼ä¸ºï¼š

```
@<æœºå™¨äººåç§°> /ç®¡ç†å‘˜æ³¨å†Œ <å¯†ç >
```


ä¾‹å¦‚ï¼Œå¯¹ä¸‰å¶è‰è¿›è¡Œç®¡ç†å‘˜æ³¨å†Œæ—¶ï¼Œå‡å¦‚å¯†ç æ˜¯ 123456ï¼Œéœ€è¦ï¼š

```
@ä¸‰å¶è‰ /ç®¡ç†å‘˜æ³¨å†Œ 123456
```


<b>æ³¨æ„ï¼š</b> ç®¡ç†å‘˜å¯†ç è¯·ä¸è¦æ³„éœ²ç»™å…¶ä»–äººï¼Œå»ºè®®å®šæœŸæ›´æ¢å¯†ç ã€‚

æ³¨å†Œæˆä¸ºç®¡ç†å‘˜ä¹‹åï¼Œä½ çš„ `member_openid` å°†ä¼šè¢«ä¿å­˜è‡³ `chatbot.db` ä¸‹çš„ `admin_list` è¡¨ä¸­ã€‚

<br>

<br>

### æ›´å¤šé…ç½®å†…å®¹ï¼Œè¯·è¯¦è§[configuration.md](docs/configuration.md)



